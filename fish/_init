#!/usr/bin/env fish
source env

function install
    brew install fish

    set fish (which fish)
    test "$SHELL" = $fish; or chsh -s $fish (whoami)
    grep -q $fish /etc/shells; or echo $fish | sudo tee -a /etc/shells > /dev/null

    mkdir -p "$XDG_CONFIG_HOME/fish/conf.d"

    set -U FISH_CONFIG_HOME "$XDG_CONFIG_HOME/fish/conf.d"
end

function link
    for f in config.fish functions completions
        _mklink fish $f
    end
end

function unlink
    _cleanup fish
end

function delete
    _cleanup fish "$XDG_CONFIG_HOME/fish/conf.d"

    set -e FISH_CONFIG_HOME
end
